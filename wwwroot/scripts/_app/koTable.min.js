ko.bindingHandlers.koTable=new function(){var n=this;n.init=function(n,t,i,r){var o=t(),u=$(n),f=$(n).find("tbody"),p=$.trim(u.attr("id")||u.attr("name")).replace("-","").replace(".","").replace("_",""),it=o.pageSize||-1,w=o.rowsClickable!=null?o.rowsClickable:!1,rt=o.showSearch===!0?!0:!1,b=o.allowSort==null?!0:o.allowSort,ut=o.initialSortProperty,ft=o.initialSortDirection==="asc"?"asc":"desc",k,l,h=u.find("tr:first th").css("border-bottom-width"),a=u.find("tr:first th").css("border-bottom-color"),c=u.find("tr:first th").css("border-bottom-style"),s=[],et=function(){s.length===0&&(s.push(!0),$.cssHooks.borderColor?(u.find("tr:first th").animate({borderBottomColor:"#FF3300"}),u.find("tr:first th").css({"border-bottom-width":h||"1px","border-bottom-style":c||"solid"}),k=setInterval(function(){l?(u.find("tr:nth-child(2) th").animate({borderBottomColor:a},null,null),l=!1):(u.find("tr:nth-child(2) th").animate({borderBottomColor:"#FF3300"},null,null),l=!0)},500)):u.find("tr:nth-child(2) th").css({"border-bottom-width":h||"1px","border-bottom-color":"#FF3300","border-bottom-style":c||"solid"}))},ot=function(){s.length===1&&(clearInterval(k),$.cssHooks.borderColor?u.find("tr:nth-child(2) th").animate({borderBottomColor:a},null,null,function(){u.find("tr:nth-child(2) th").css({"border-bottom-width":h,"border-bottom-style":c});s.pop()}):(u.find("tr:nth-child(2) th").css({"border-bottom-width":h,"border-bottom-color":a,"border-bottom-style":c}),s.pop()))},v=new KnockoutTable(it,b,ut,ft,w,et,ot),e,tt;v.setItems([]);r.koTable={};$("table[data-bind*=koTable]").length===1?e=$.extend(r.koTable,v):(r.koTable[p]={},e=$.extend(r.koTable[p],v));r.onInit.call();e.onRowsClickableChanged(function(n){f.css("cursor","default");f.off("click");n&&n.data===!0&&f.length&&(f.css("cursor","pointer"),f.click(e.rowClickedCallback))});if(f.css("cursor","default"),f.off("click"),w&&f.css("cursor","pointer"),f.length?f.click(function(n){var t=$(n.target);t.closest("button").length||t.closest("a").length||e.rowClickedCallback(n)}):f.length||$.error("The table has no tbody element so row clicking will not be enabled!"),b){var d='<span class="sort-icon glyphicon glyphicon-triangle-bottom" aria-hidden="true" style="margin-left:5px; color:silver; font-size: 10px;"><\/span>',g='<span class="sort-icon glyphicon glyphicon-triangle-top" aria-hidden="true" style="margin-left:5px; color:silver; font-size: 10px;"><\/span>',y=$("[data-sort-property]");y.css("cursor","pointer");var st=e.sortDirection(),ht=e.sortProperty(),nt=$("[data-sort-property='"+ht+"']");st==="desc"?nt.append(d):nt.append(g);y.click(function(){y.find(".sort-icon").remove();var i=e.sortProperty(),n=$(this).attr("data-sort-property"),t="asc";i===n?t=e.toggleSortDirection():e.sortProperty(n);t==="desc"?$(this).append(d):$(this).append(g)})}$.each(u.find(".ko-table-pagination"),function(n,t){$(t).html('<span data-bind="if: !koTable.hasRows()">There are no records to show at the moment :(<\/span><ul class="pagination" data-bind="if: koTable.paginationRequired()" style="padding: 0 !important; margin: 5px 0 5px 0 !important;" ><li data-bind="css: { disabled: koTable.isFirstPage }"><a href="#" data-bind="click: koTable.gotoFirstPage"><span class="glyphicon glyphicon-step-backward" aria-hidden="true"><\/span><\/a><\/li><li data-bind="css: { disabled: koTable.isFirstPage }"><a href="#" data-bind="click: koTable.gotoPreviousPage"><span class="glyphicon glyphicon-backward" aria-hidden="true"><\/span><\/a><\/li><!-- ko foreach: koTable.paginationIndexes() --><li data-bind="css: { active: $data==$parent.koTable.currentPage() }"><a href="#" data-bind="click: $parent.koTable.gotoPage"><span data-bind="text: ($data+1)"><\/span><\/a><\/li><!-- /ko --><li data-bind="css: { disabled: koTable.isLastPage }"><a href="#" data-bind="click: koTable.gotoNextPage"><span class="glyphicon glyphicon-forward" aria-hidden="true"><\/span><\/a><\/li><li data-bind="css: { disabled: koTable.isLastPage }"><a href="#" data-bind="click: koTable.gotoLastPage"><span class="glyphicon glyphicon-fast-forward" aria-hidden="true"><\/span><\/a><\/li><\/ul>').closest("td, th").css({"padding-left":0,"padding-right":0,"text-align":"left"}).attr("colspan",100)});rt?$.each(u.find(".ko-table-search"),function(n,t){$(t).addClass("input-group").css({width:"100%"});$(t).html('<span class="glyphicon glyphicon-search input-group-addon input-group-sm" style="top: 0;"><\/span><input type="text" class="form-control" placeholder="search..." value="" />');$(t).find("input[type='text']").on("input",function(n){clearTimeout(tt);tt=setTimeout(function(){var r=$(n.target),u=r.val(),i=$(t).find("span:first");if(i.removeClass("glyphicon-search").removeClass("glyphicon-remove"),u.length>0)i.addClass("glyphicon-remove").css({cursor:"pointer"}).one("click",function(){$(this).removeClass("glyphicon-remove").addClass("glyphicon-search").css({cursor:"default"});r.val("").trigger("input")});else i.addClass("glyphicon-search");e.setRowFilter(u)},500)});$(t).closest("td, th").css({"padding-left":0,"padding-right":0}).attr("colspan",100).closest("tr")}):u.find(".ko-table-search").closest("td, th").attr("colspan",100).hide();u.find("thead").prepend('<tr><th colspan="100" class="text-right" style="border-color: none !important;border-width: 0 !important;margin:0; padding:0;font-size:10px; font-weight: normal;"><em><span class="text-muted" data-bind="text: \'Row Count: \' + koTable.rowCount()"><\/span><\/em><\/th><\/tr>')}};var KnockoutTable=function(){function n(n,t,i,r,u,f,e){function d(n,t){var u=ko.unwrap(n),f=ko.unwrap(t),i=ko.unwrap(u[o.sortProperty()]),r=ko.unwrap(f[o.sortProperty()]);return typeof i=="string"&&(i=i.toUpperCase(),r=r.toUpperCase()),o.sortDirection()==="desc"?i<r?1:i>r?-1:0:i<r?-1:i>r?1:0}var o=this,k=5,a={onWaitStart:"onWaitStart",onWaitEnd:"onWaitEnd",onRowClicked:"onRowClicked",onRowsClickableChanged:"onRowsClickableChanged"},h=ko.observableArray([]),v=ko.observable({allowSort:t,sortProperty:i,sortDirection:$.trim(r||"asc").toLowerCase()}),c=ko.observable(n&&n>0?n:-1),b=ko.observable(u===!0),y=ko.observable(""),l,s,p,w;o.currentPage=ko.observable(0);o.setRowFilter=function(n){var t=ko.unwrap(n);$.trim(t.toString()).length>=2?y(t.toString().toLowerCase()):y("")};l=ko.pureComputed({read:function(){if(y()&&y().length){var n=[];return $.each(h(),function(t,i){var r=ko.mapping.toJS(i),u,f,e;for(u in r)if(r.hasOwnProperty(u)&&(f=(r[u]==null?"":r[u]).toString().toLowerCase(),e=f.indexOf(y())>=0,e)){n.push(i);break}}),n}return h()},write:function(n){h(n)}},o);o.rowClickedCallback=function(n){if(b()){var t=$(n.target).closest("tr"),i=ko.dataFor(t.get(0));w(a.onRowClicked,{clickEvent:n,tr:t,model:i})}};o.rowsClickable=ko.computed({read:function(){return b()},write:function(n){var i=b(),t=n===!0?!0:!1;n===!1||n||(t=t?!1:!0);i!==t&&(w(a.onRowsClickableChanged,t),b(t))}},o);o.pageSize=ko.computed({read:function(){return c()},write:function(n){var t=c(),i=parseInt(n);t!==i&&(n=Math.max(1,n),c(n))}},o);o.sortProperty=ko.computed({read:function(){return v().sortProperty},write:function(n){var r=v().sortProperty,i=$.trim(ko.unwrap(n)),t;r!==i&&(t=v(),t.sortProperty=i,t.sortDirection="asc",v(t))}},o);o.sortDirection=ko.pureComputed({read:function(){return v().sortDirection},write:function(n){var r=v().sortDirection,i=$.trim(ko.unwrap(n)||"asc").toLowerCase(),t;r!==i&&(t=v(),t.sortDirection=i,v(t))}},o);o.toggleSortDirection=function(){var t=o.sortDirection(),n=t==="asc"?"desc":"asc";return o.sortDirection(n),n};o.clearItems=function(){l([]);o.currentPage(-1);o.currentPage(0)};o.pushItem=function(n){h.push(ko.mapping.fromJS(ko.mapping.toJS(n)))};o.allItems=function(){return h()};o.observableItems=function(){return h};o.distinctValues=function(n,t){var i=[];return(t==null||typeof t!="function")&&(t=function(n){return n==null?"":n.toString()}),$.each(h(),function(r,u){var e=ko.unwrap(u),f=ko.unwrap(e[n]);f=t(f);$.inArray(f,i)===-1&&i.push(f)}),i.sort()};o.setItems=function(n){var t;o.clearItems();t=n;typeof n=="function"&&(t=n.apply(null,Array.prototype.slice.call(arguments,1)));t=t||[];t=$.map(t,function(n){var t=ko.mapping.toJS(n);return ko.mapping.fromJS(t)});l(t)};o.findItem=function(n,t){var i=ko.unwrap(t);return $.grep(h(),function(t){var r=ko.unwrap(t),u=ko.unwrap(r[n]);return u===i})};o.removeItem=function(n){var t=$.grep(h(),function(t){return n===t});$.each(t,function(n,t){h.remove(t)})};o.gotoNextPage=function(){o.currentPage()<o.pageCount()-1&&o.currentPage(o.currentPage()+1)};o.gotoPreviousPage=function(){o.currentPage()>0&&o.currentPage(o.currentPage()-1)};o.gotoLastPage=function(){o.currentPage(o.pageCount()-1)};o.gotoFirstPage=function(){o.currentPage(0)};o.gotoPage=function(n){var t=n||0;t!==o.currentPage()&&o.currentPage(t)};o.isFirstPage=ko.pureComputed(function(){return o.currentPage()===0});o.isLastPage=ko.pureComputed(function(){return o.currentPage()===o.pageCount()-1});o.pageCount=ko.pureComputed(function(){return Math.ceil(c()>0?l().length/c()||1:1)});o.paginationIndexes=ko.pureComputed(function(){for(var u=(k-1)/2,t=Math.min(Math.max(o.currentPage()+u,o.currentPage()+k),o.pageCount()),i=Math.max(0,t-k),r=[],n=0;n<t-i;n++)r.push(i+n);return r});o.pagedItems=ko.pureComputed(function(){var n=c()>0?c()*o.currentPage():0,t=c()>0?n+c():o.rowCount();return o.sortProperty()?l().sort(d).slice(n,t):l().slice(n,t)});o.hasRows=ko.pureComputed(function(){return l()&&l().length>0},o);o.paginationRequired=ko.pureComputed(function(){return o.hasRows()&&o.pageCount()>1},o);o.rowCount=ko.pureComputed(function(){return o.hasRows()?l().length:0});s={};o.onRowClicked=function(n){p(a.onRowClicked,n)};o.onRowsClickableChanged=function(n){p(a.onRowsClickableChanged,n)};o.waitStart=function(){w(a.onWaitStart)};o.waitEnd=function(){w(a.onWaitEnd)};p=function(n,t){typeof s[n]=="undefined"&&(s[n]=[]);var i=!1;s[n]&&s[n].length>0&&$.each(s[n],function(n,r){return r.name&&r.name.length&&t.name&&t.name.length?(i=r===t,!i):(i=r.toString()===t.toString(),!i)});i||s[n].push(t)};w=function(n,t){var r,i,u;if(typeof n=="string"&&(n={type:n}),n.data=t,n.target||(n.target=o),n.type||$.error("Event object missing 'type' property."),s[n.type]instanceof Array)for(r=s[n.type],i=0,u=r.length;i<u;i++)r[i].call(o,n)};o.removeListener=function(n,t){var r,i,u;if(s[n]instanceof Array)for(r=s[n],i=0,u=r.length;i<u;i++)if(r[i]===t){r.splice(i,1);break}};p(a.onWaitStart,f);p(a.onWaitEnd,e)}return n}();
//# sourceMappingURL=koTable.min.js.map
