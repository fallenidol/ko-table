$.fn.pulse=function(n){var t={times:2,duration:250},i=function(n){$(this).animate({opacity:.2},t.duration,function(){$(this).animate({opacity:1},t.duration,n)})};this.each(function(){var r=t.times,f=this,u=function(){return r=r-1,!r&&n&&typeof n=="function"?n():i.call(f,u),r};i.call(this,u)})};trace=function(n){log(n,0)};debug=function(n){log(n,1)};warn=function(n){log(n,2)};error=function(n){log(n,3)};log=function(n,t){!0&&t>=1&&window.console&&window.console.log&&window.console.log(n)};ko.bindingHandlers.koTable=new function(){var n=this;n.init=function(n,t,i,r){var u,v,y,p,w,s,g;trace("koTable init!");var e=t(),o=$(n),c=$(n).find("thead"),f=$(n).find("tbody"),nt=e.pageSize||-1,l=e.rowsClickable!=null?e.rowsClickable:!1,tt=e.showSearch===!0?!0:!1,a=e.allowSort==null?!0:e.allowSort,it=e.initialSortProperty,rt=e.initialSortDirection==="asc"?"asc":"desc",ut=e.showDeleteRowButton===!0?!0:!1,ft=e.showEditRowButton===!0?!0:!1,et=new KnockoutTable(nt,a,it,rt,l);if(r.koTable={},u=$.extend(r.koTable,et),ft===!0&&(c.find("tr").each(function(n,t){var i=$(t);i.find(".ko-table-search").length===0&&i.prepend('<th class="edit-column text-center"><\/th>')}),f.find("tr").each(function(n,t){var i=$(t);i.find("td [data-bind]").length&&i.prepend('<td class="edit-column text-center" style="cursor:pointer;width:0px;padding-left:0;padding-right:0;"><a class="edit-btn"><span class="glyphicon glyphicon-edit text-default small" style="margin:0;"><\/span><\/a><\/td>')}),u.modalRow=null,u.modalOriginalItem=null,u.modalItem=ko.observable(),v='<div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="editModalLabel">                <div class="modal-dialog" role="document">                    <div class="modal-content">                        <div class="modal-header">                            <button type="button" class="close close-button" aria-label="Close"><span aria-hidden="true">&times;<\/span><\/button>                            <h4 class="modal-title" id="editModalLabel">Edit Record<\/h4>                        <\/div>                        <div class="modal-body" data-bind="template: { name: \'modal-template\', data: $data.koTable }"><\/div>                        <div class="modal-footer">                            <button type="button" class="btn btn-default btn-sm close-button"><span class="glyphicon glyphicon-remove"><\/span>&nbsp;Cancel<\/button>                            <button type="button" class="btn btn-primary btn-sm save-button"><span class="glyphicon glyphicon-floppy-disk"><\/span>&nbsp;Save<\/button>                        <\/div>                    <\/div>                <\/div>            <\/div>',$(n).find("tfoot td:first").append(v),$(n).find("#editModal .close-button").click(function(){$(n).find("#editModal").modal("hide");u.modalRow&&u.modalRow.find("td.bg-info").removeClass("bg-info")}),$(n).find("#editModal .save-button").click(function(){u.modalItem()?w({model:ko.mapping.toJS(u.modalItem()),completedCallback:function(t){var i,f,r;$(n).find("#editModal").modal("hide");i=ko.mapping.toJS(u.modalItem());f=!i.id;f?(i.id=parseInt(t),u.pushItem(i)):ko.mapping.fromJS(i,u.modalOriginalItem);r=u.modalRow;r&&r.find("td").addClass("bg-info").pulse(function(){r.find("td").removeClass("bg-info")})}}):$(n).find("#editModal").modal("hide")})),ut===!0&&(c.find("tr").each(function(n,t){var i=$(t);i.find(".ko-table-search").length===0&&i.prepend('<th class="delete-column text-center"><\/th>')}),f.find("tr").each(function(n,t){var i=$(t);i.find("td [data-bind]").length&&i.prepend('<td class="delete-column text-center" style="cursor:pointer;width:0px;padding-left:0;padding-right:0;"><a class="delete-btn"><span class="glyphicon glyphicon-trash text-danger small" style="margin:0;"><\/span><\/a><\/td>')})),r.koTable.addRowClickedHandler=function(n){n&&typeof n=="function"&&(y=n)},r.koTable.addRowDeleteHandler=function(n){n&&typeof n=="function"&&(p=n)},r.koTable.addRowSaveHandler=function(n){n&&typeof n=="function"&&(w=n)},r.koTableReady.call(),s=function(n){var r=$(n.target),t,f,i;r&&(t=$(n.target).closest("tr"),t&&t.length>=0&&(f=t.get(0),f&&(i=ko.dataFor(t.get(0)),r.closest("button").length||r.closest("a").length?r.closest(".delete-column").length?(t.find("td").addClass("danger"),p({event:n,tr:t,model:ko.mapping.toJS(i),completedCallback:function(){t.find("td").pulse(function(){u.removeItem(i)})}})):r.closest(".edit-column").length&&(u.modalItem()?ko.mapping.fromJS(ko.mapping.toJS(i),u.modalItem()):u.modalItem(ko.mapping.fromJS(ko.mapping.toJS(i))),u.modalRow=t,u.modalOriginalItem=i,t.find("td").addClass("bg-info"),$("#editModal").modal("show")):y({event:n,tr:t,model:i}))))},u.rowsClickable.subscribe(function(n){f.css("cursor","default");f.off("click");n===!0&&f.length&&f.css("cursor","pointer");f.click(s)}),f.css("cursor","default"),f.off("click"),l&&f.css("cursor","pointer"),f.length?f.click(s):f.length||$.error("The table has no tbody element so row clicking will not be enabled!"),a){var b='<span class="sort-icon glyphicon glyphicon-triangle-bottom" aria-hidden="true" style="margin-left:5px; color:silver; font-size: 10px;"><\/span>',k='<span class="sort-icon glyphicon glyphicon-triangle-top" aria-hidden="true" style="margin-left:5px; color:silver; font-size: 10px;"><\/span>',h=$("[data-sort-property]");h.css("cursor","pointer");var ot=u.sortDirection(),st=u.sortProperty(),d=$("[data-sort-property='"+st+"']");ot==="desc"?d.append(b):d.append(k);h.click(function(){h.find(".sort-icon").remove();var i=u.sortProperty(),n=$(this).attr("data-sort-property"),t="asc";i===n?t=u.toggleSortDirection():u.sortProperty(n);t==="desc"?$(this).append(b):$(this).append(k)})}$.each(o.find(".ko-table-pagination"),function(n,t){$(t).html('<span data-bind="if: !koTable.hasRows()">There are no records to show at the moment :(<\/span><ul class="pagination" data-bind="if: koTable.paginationRequired()" style="padding: 0 !important; margin: 5px 0 5px 0 !important;" ><li data-bind="css: { disabled: koTable.isFirstPage }"><a href="#" data-bind="click: koTable.gotoFirstPage"><span class="glyphicon glyphicon-step-backward" aria-hidden="true"><\/span><\/a><\/li><li data-bind="css: { disabled: koTable.isFirstPage }"><a href="#" data-bind="click: koTable.gotoPreviousPage"><span class="glyphicon glyphicon-backward" aria-hidden="true"><\/span><\/a><\/li><!-- ko foreach: koTable.paginationIndexes() --><li data-bind="css: { active: $data==$parent.koTable.currentPage() }"><a href="#" data-bind="click: $parent.koTable.gotoPage"><span data-bind="text: ($data+1)"><\/span><\/a><\/li><!-- /ko --><li data-bind="css: { disabled: koTable.isLastPage }"><a href="#" data-bind="click: koTable.gotoNextPage"><span class="glyphicon glyphicon-forward" aria-hidden="true"><\/span><\/a><\/li><li data-bind="css: { disabled: koTable.isLastPage }"><a href="#" data-bind="click: koTable.gotoLastPage"><span class="glyphicon glyphicon-fast-forward" aria-hidden="true"><\/span><\/a><\/li><\/ul><div class="text-muted pull-right" style="height:34px; line-height:34px;" data-bind="visable: koTable.rowCount(), text: \'Row Count: \' + koTable.rowCount()"><\/div>').closest("td, th").css({"padding-left":0,"padding-right":0,"text-align":"left"}).attr("colspan",100)});tt?$.each(o.find(".ko-table-search"),function(n,t){$(t).addClass("input-group").css({width:"100%"});$(t).html('<span class="glyphicon glyphicon-search input-group-addon input-group-sm" style="top: 0;"><\/span><input type="text" class="form-control" placeholder="search..." value="" />');$(t).find("input[type='text']").on("input",function(n){clearTimeout(g);g=setTimeout(function(){var r=$(n.target),f=r.val(),i=$(t).find("span:first");if(i.removeClass("glyphicon-search").removeClass("glyphicon-remove"),f.length>0)i.addClass("glyphicon-remove").css({cursor:"pointer"}).one("click",function(){i.removeClass("glyphicon-remove").addClass("glyphicon-search").css({cursor:"default"});r.val("").trigger("input")});else i.addClass("glyphicon-search");u.setRowFilter(f)},500)});$(t).closest("td, th").css({"padding-left":0,"padding-right":0}).attr("colspan",100).closest("tr")}):o.find(".ko-table-search").closest("td, th").attr("colspan",100).hide()}};var KnockoutTable=function(){function n(n,t,i,r,u){function p(n,t){trace("objectSortComparer...");var u=ko.unwrap(n),e=ko.unwrap(t),i=ko.unwrap(u[f.sortProperty()]),r=ko.unwrap(e[f.sortProperty()]);return typeof i=="string"&&(i=i.toUpperCase(),r=r.toUpperCase()),f.sortDirection()==="desc"?i<r?1:i>r?-1:0:i<r?-1:i>r?1:0}var f=this,l=5,y={onRowClicked:"onRowClicked",onRowsClickableChanged:"onRowsClickableChanged",onRowDeleteClicked:"onRowDeleteClicked"},e=ko.observableArray([]),h=ko.observable({allowSort:t,sortProperty:i,sortDirection:$.trim(r||"asc").toLowerCase()}),s=ko.observable(n&&n>0?n:-1),a=ko.observable(u===!0),v=ko.observable(""),c;f.currentPage=ko.observable(0);f.setRowFilter=function(n){trace("setRowFilter...");var t=ko.unwrap(n);$.trim(t.toString()).length>=2?v(t.toString().toLowerCase()):v("")};c=ko.pureComputed({read:function(){var n,t;return(trace(["read items...",e()]),n=ko.unwrap(v),n&&n.length)?(t=[],$.each(e(),function(i,r){var u,f,e,o;trace("item...");u=ko.mapping.toJS(r);for(f in u)if(trace("item2..."),u.hasOwnProperty(f)&&(e=(u[f]==null?"":u[f]).toString().toLowerCase(),o=e.indexOf(n)>=0,o)){t.push(r);break}}),t):e()},write:function(n){trace("write items...");e(n)}},f);f.rowsClickable=ko.computed({read:function(){return trace("rowsClickable...read"),a()},write:function(n){trace("rowsClickable...write");var i=a(),t=n===!0?!0:!1;n===!1||n||(t=t?!1:!0);i!==t&&(w(y.onRowsClickableChanged,t),a(t))}},f);f.pageSize=ko.computed({read:function(){return trace("pageSize...read"),s()},write:function(n){trace("pageSize...write");var t=s(),i=parseInt(n);t!==i&&(n=Math.max(1,n),s(n))}},f);f.sortProperty=ko.computed({read:function(){return trace("sortProperty...read"),h().sortProperty},write:function(n){var r,i,t;trace("sortProperty...write");r=h().sortProperty;i=$.trim(ko.unwrap(n));r!==i&&(t=h(),t.sortProperty=i,t.sortDirection="asc",h(t))}},f);f.sortDirection=ko.pureComputed({read:function(){return trace("sortDirection...read"),h().sortDirection},write:function(n){var r,t,i;trace("sortDirection...write");r=h().sortDirection;t=$.trim(ko.unwrap(n)||"asc").toLowerCase();r!==t&&(i=h(),i.sortDirection=t,h(i))}},f);f.toggleSortDirection=function(){trace("toggleSortDirection...");var t=f.sortDirection(),n=t==="asc"?"desc":"asc";return f.sortDirection(n),n};f.clearItems=function(){trace("clearItems...");e([]);f.currentPage(-1);f.currentPage(0)};f.pushItem=function(n){trace("pushItem...");e.push(ko.mapping.fromJS(ko.mapping.toJS(n)))};f.allItems=function(){return trace("allItems..."),e()};f.observableItems=function(){return trace("observableItems..."),e};f.distinctValues=function(n,t){trace("distinctValues...");var i=[];return(t==null||typeof t!="function")&&(t=function(n){return n==null?"":n.toString()}),$.each(e(),function(r,u){var e=ko.unwrap(u),f=ko.unwrap(e[n]);f=t(f);$.inArray(f,i)===-1&&i.push(f)}),i.sort()};f.setItems=function(n){trace("setItems...");f.clearItems();var t=n;typeof n=="function"&&(t=n.apply(null,Array.prototype.slice.call(arguments,1)));t=t||[];t=$.map(t,function(n){var t=ko.mapping.toJS(n);return ko.mapping.fromJS(t)});e(t)};f.findItem=function(n,t){trace("findItem...");var i=ko.unwrap(t);return $.grep(e(),function(t){var r=ko.unwrap(t),u=ko.unwrap(r[n]);return u===i})};f.removeItem=function(n){trace("removeItem...");var t=$.grep(e(),function(t){return n===t});$.each(t,function(n,t){e.remove(t)})};f.gotoNextPage=function(){trace("gotoNextPage...");f.currentPage()<f.pageCount()-1&&f.currentPage(f.currentPage()+1)};f.gotoPreviousPage=function(){trace("gotoPreviousPage...");f.currentPage()>0&&f.currentPage(f.currentPage()-1)};f.gotoLastPage=function(){trace("gotoLastPage...");f.currentPage(f.pageCount()-1)};f.gotoFirstPage=function(){trace("gotoFirstPage...");f.currentPage(0)};f.gotoPage=function(n){trace("gotoPage...");var t=n||0;t!==f.currentPage()&&f.currentPage(t)};f.isFirstPage=ko.pureComputed(function(){return trace("isFirstPage..."),f.currentPage()===0});f.isLastPage=ko.pureComputed(function(){return trace("isLastPage..."),f.currentPage()===f.pageCount()-1});f.pageCount=ko.pureComputed(function(){return trace("pageCount..."),Math.ceil(s()>0?c().length/s()||1:1)});f.paginationIndexes=ko.pureComputed(function(){var n;trace("paginationIndexes...");var u=(l-1)/2,t=Math.min(Math.max(f.currentPage()+u,f.currentPage()+l),f.pageCount()),i=Math.max(0,t-l),r=[];for(n=0;n<t-i;n++)r.push(i+n);return r});f.pagedItems=ko.pureComputed(function(){var n=s()>0?s()*f.currentPage():0,i=s()>0?n+s():f.rowCount(),t;return t=f.sortProperty()?c().sort(p).slice(n,i):c().slice(n,i),trace("pagedItems... "+t.length),t});f.hasRows=ko.pureComputed(function(){return trace("hasRows..."),c()&&c().length>0},f);f.paginationRequired=ko.pureComputed(function(){return trace("paginationRequired..."),f.hasRows()&&f.pageCount()>1},f);f.rowCount=ko.pureComputed(function(){return trace("rowCount..."),f.hasRows()?c().length:0});var o={},b=function(n,t){trace("addEventHandler...");typeof o[n]=="undefined"&&(o[n]=[]);var i=!1;o[n]&&o[n].length>0&&$.each(o[n],function(n,r){return r.name&&r.name.length&&t.name&&t.name.length?(i=r===t,!i):(i=r.toString()===t.toString(),!i)});i||o[n].push(t)},w=function(n,t){var r,i,u;if(trace("trigger..."),typeof n=="string"&&(n={type:n}),n.data=t,n.target||(n.target=f),n.type||$.error("Event object missing 'type' property."),o[n.type]instanceof Array)for(r=o[n.type],i=0,u=r.length;i<u;i++)r[i].call(f,n)};f.removeListener=function(n,t){var r,i,u;if(trace("removeListener..."),o[n]instanceof Array)for(r=o[n],i=0,u=r.length;i<u;i++)if(r[i]===t){r.splice(i,1);break}}}return n}();
//# sourceMappingURL=koTable.min.js.map
